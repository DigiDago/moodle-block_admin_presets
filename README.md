# Admin presets for Moodle

Block to export and import Moodle administration settings

## Build status

[![Build Status](https://travis-ci.org/DigiDago/moodle-block_admin_presets.svg?branch=master)](https://travis-ci.org/DigiDago/moodle-block_admin_presets)

## Features

* Export system settings to XML files
* Import presets files
* Preset preview and partial load
* Allows rollback
* Option to autoexclude the sensitive data when exporting settings (you can edit the sensitive settings list in Site Administration -> Plugins -> Blocks -> Admin presets)
* Third parties plugins supported

## See also
* Modules and Plugins entry: https://moodle.org/plugins/view.php?plugin=block_admin_presets


Maintainer
============
AdminPreset was initialy developed by David MonllaÃ³. It is currently maintained by Pimenko team.


Any Problems, questions, suggestions
===================
If you have a problem with this block, suggestions for improvement, drop an email at :
- Pimenko :  contact@pimenko.com
- Github : https://github.com/DigiDago/moodle-block_admin_presets

Usage
===================
- **Check if plugin is installed :** 
go to *Admin > Plugins > Plugins overview > Additional Plugins > Admin presets*. It's installed if it appears.
- **Set-up the block :**  Make the block appear in your 'Site Home' page by adding it to the page, go to *Site Home > Turn Editing On*. Then go to *Add Block > Admin presets*
- **Usage :** In the 'Site Home' page, an admin_preset block should now appear. from there you can

  - **Import a config file :** Just drag&drop a config_file generated by admin_presets from this moodle or another one. Just in case, before importing anything you should always export your actual configuration to be able to retrieve it later.
  - **Export your current config :** Select all the settings you wish to be in your export file, **by default all settings are selected**. Be careful not to select unnecessary settings because the selected settings will always override previous settings at the import. The config.xml file won't be downloaded right away, you will find it in the presets list.
  - **See the presets list :** Here are listed all the imported & exported config files, from there you can
    - Preview : see the config to check which settings are contained
    - Load : load the config onto the site
    - Download : download a .xml fil containing the config, allowing you to import it to any moodle project running the admin_presets plugin
    - Delete : permanently remove that configuration from de presets list
> Carefull : settings related to the Moodle Theme are exported/imported but the used theme still needs to be set manually.


Automatic Export
===================
A feature was added allowing the plugin to perform an automatic export which will provide a daily back-up if enabled. You can enable this setting the same way you're configuring the plugin following : *Admin > Plugins > Plugins overview > Additional Plugins > Admin presets > Settings*.
These backups are named with a timestamp looking like '20210816160918'  and will be found with any other record of admin_presets : in the "presets" list that regroups exports, imports and automatic backups.

### How it works
- Automatic export daily at 23:00, creates an export with full config named with a time stamp **default : Enabled**
- Automatic export cleanup runs daily at 23:30, will delete automatic exports as follows
  - Last 7 weeks : keeps all
  - Last 14 days : keeps one export out of 2
  - Last month : keeps one export out of 4
  - Last 3 months : keeps one export out of 8
  - Older than 3 months : deletes all
> This feature only targets automatic exports, if you perform a manual export or import they'll stay untouched.
> 
> If you import an automatic export in this project or another, it won't be targeted by this cleanup feature
